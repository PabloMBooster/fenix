axis(2)
box()
if(is.null(nombre_indice_legenda)){
nombre_indice_legenda <- nombre_indice
}
if(is.null(nombre_patron)){
nombre_patron <- "Patrón"
}
if(is.null(nombre_crucero)){
legend("toprigh",c(nombre_patron, nombre_indice_legenda), lty = c(1,1), lwd = c(2,2),col = c(2,4),bty = "n")
}else{
legend("toprigh",c(nombre_patron, nombre_indice_legenda, nombre_crucero), lty = c(1,1,0), lwd = c(2,2,NA),pch = c(NA,NA,16), col = c(2,4,1),bty = "n")
}
}
data <- read.csv("D:/2018/Cr_180204/datos/indices_reproductivos/data_ejemplo.csv")
data <- read.csv("D:/2018/Cr_180204/datos/indices_reproductivos/data_ejemplo.csv")
data$fecha <- as.Date(data$fecha, format = "%d/%m/%Y")
plot_repro(tiempo = data$fecha, indice = data$IGS, patron = data$patron_igs, sd_patron = data$ds_igs, valor_crucero = 5,
nombre_indice = "Índice gonodosomático (IGS)", nombre_indice_legenda = "IGS", nombre_patron = "Patrón", nombre_crucero = "Cr_1802_04")
data
plot_repro <- function(tiempo, indice, patron, sd_patron, valor_crucero = NULL,
nombre_indice = NULL, nombre_indice_legenda = NULL,  nombre_patron = NULL,
nombre_crucero = NULL){
require(plotrix)
x <- 1:length(indice)
y <- patron
uwi <- sd_patron
lwi <- sd_patron
if(is.null(nombre_indice)){
nombre_indice = "nombre indice"
}
plotCI(x, y,uwi,lwi, lwd = 1, col = "red", scol = "gray30",slty = 1, ui = 2,
,xlab="", pt.bg=par("bg"),pch = ".",
ylab=nombre_indice,ylim = c(0,round(max(y)+max(uwi))+2),
axes=F)
lines(x,y, col = 2,lwd = 2)
lines(x,indice,col = 4,lwd = 2)
if(!is.null(valor_crucero)){
points(length(tiempo),valor_crucero, col = 1,pch = 16)
}
axis(1,at=1:length(tiempo),labels=substring(tiempo, 1,7),las=2,cex.axis=1,tcl = -0.2,hadj = 0.8)
axis(1,at=1:length(time),labels=FALSE,tcl = -0.5)
abline(v = which(substring(tiempo,6,7) %in% "01"), col = 1, lty = 2)
axis(2)
box()
if(is.null(nombre_indice_legenda)){
nombre_indice_legenda <- nombre_indice
}
if(is.null(nombre_patron)){
nombre_patron <- "Patrón"
}
if(is.null(nombre_crucero)){
legend("toprigh",c(nombre_patron, nombre_indice_legenda), lty = c(1,1), lwd = c(2,2),col = c(2,4),bty = "n")
}else{
legend("toprigh",c(nombre_patron, nombre_indice_legenda, nombre_crucero), lty = c(1,1,0), lwd = c(2,2,NA),pch = c(NA,NA,16), col = c(2,4,1),bty = "n")
}
}
plot_repro(tiempo = data$fecha, indice = data$FD, patron = data$patron_fd, sd_patron = data$ds_fd, valor_crucero = NULL,
nombre_indice = "Factor de condición", nombre_indice_legenda = "FD", nombre_patron = "Patrón", nombre_crucero = NULL)
data$IGS
data$patron_igs
plot_repro(tiempo = data$fecha, indice = data$IGS, patron = data$IGS_PATRON, sd_patron = data$IGS_SD, valor_crucero = 5,
nombre_indice = "Índice gonodosomático (IGS)", nombre_indice_legenda = "IGS", nombre_patron = "Patrón", nombre_crucero = "Cr_1802_04")
plot_repro(tiempo = data$fecha, indice = data$FD, patron = data$FD_PATRON, sd_patron = data$FD_SD, valor_crucero = NULL,
nombre_indice = "Factor de condición", nombre_indice_legenda = "FD", nombre_patron = "Patrón", nombre_crucero = NULL)
plot_repro(tiempo = data$fecha, indice = data$CG, patron = data$CG_SD, sd_patron = data$CG_SD, valor_crucero = NULL,
nombre_indice = "CG", nombre_indice_legenda = "CG", nombre_patron = "Patrón", nombre_crucero = NULL)
plot_repro(tiempo = data$fecha, indice = data$IA, patron = data$IA_SD, sd_patron = data$IA_SD, valor_crucero = NULL,
nombre_indice = "IA", nombre_indice_legenda = "IA", nombre_patron = "Patrón", nombre_crucero = NULL)
plot_repro(tiempo = data$fecha, indice = data$IA, patron = data$IA_PATRON, sd_patron = data$IA_SD, valor_crucero = NULL,
nombre_indice = "IA", nombre_indice_legenda = "IA", nombre_patron = "Patrón", nombre_crucero = NULL)
plot_repro(tiempo = data$fecha, indice = data$FC, patron = data$FC_PATRON, sd_patron = data$FC_SD, valor_crucero = NULL,
nombre_indice = "FC", nombre_indice_legenda = "FC", nombre_patron = "Patrón", nombre_crucero = NULL)
data$FC
data$FC_PATRON
data$FC_SD
max(data$FC_SD)
max(data$FC_SD)+max(data$FC_PATRON)
round(max(data$FC_SD)+max(data$FC_PATRON))
valor_max = round(max(y)+max(uwi))+2
valor_max
plot_repro <- function(tiempo, indice, patron, sd_patron, valor_crucero = NULL,
nombre_indice = NULL, nombre_indice_legenda = NULL,  nombre_patron = NULL,
nombre_crucero = NULL){
require(plotrix)
x <- 1:length(indice)
y <- patron
uwi <- sd_patron
lwi <- sd_patron
valor_max = round(max(y)+max(uwi))+2
if(valor_max > 1){
valor_max = 1
}
if(is.null(nombre_indice)){
nombre_indice = "nombre indice"
}
plotCI(x, y,uwi,lwi, lwd = 1, col = "red", scol = "gray30",slty = 1, ui = 2,
,xlab="", pt.bg=par("bg"),pch = ".",
ylab=nombre_indice,ylim = c(0,valor_max),
axes=F)
lines(x,y, col = 2,lwd = 2)
lines(x,indice,col = 4,lwd = 2)
if(!is.null(valor_crucero)){
points(length(tiempo),valor_crucero, col = 1,pch = 16)
}
axis(1,at=1:length(tiempo),labels=substring(tiempo, 1,7),las=2,cex.axis=1,tcl = -0.2,hadj = 0.8)
axis(1,at=1:length(time),labels=FALSE,tcl = -0.5)
abline(v = which(substring(tiempo,6,7) %in% "01"), col = 1, lty = 2)
axis(2)
box()
if(is.null(nombre_indice_legenda)){
nombre_indice_legenda <- nombre_indice
}
if(is.null(nombre_patron)){
nombre_patron <- "Patrón"
}
if(is.null(nombre_crucero)){
legend("toprigh",c(nombre_patron, nombre_indice_legenda), lty = c(1,1), lwd = c(2,2),col = c(2,4),bty = "n")
}else{
legend("toprigh",c(nombre_patron, nombre_indice_legenda, nombre_crucero), lty = c(1,1,0), lwd = c(2,2,NA),pch = c(NA,NA,16), col = c(2,4,1),bty = "n")
}
}
plot_repro(tiempo = data$fecha, indice = data$FC, patron = data$FC_PATRON, sd_patron = data$FC_SD, valor_crucero = NULL,
nombre_indice = "FC", nombre_indice_legenda = "FC", nombre_patron = "Patrón", nombre_crucero = NULL)
plot_repro <- function(tiempo, indice, patron, sd_patron, valor_crucero = NULL,
nombre_indice = NULL, nombre_indice_legenda = NULL,  nombre_patron = NULL,
nombre_crucero = NULL){
require(plotrix)
x <- 1:length(indice)
y <- patron
uwi <- sd_patron
lwi <- sd_patron
valor_min = 0
valor_max = round(max(y)+max(uwi))+2
if(valor_max > 1){
valor_max = 0.8
valor_min = 0.5
}
if(is.null(nombre_indice)){
nombre_indice = "nombre indice"
}
plotCI(x, y,uwi,lwi, lwd = 1, col = "red", scol = "gray30",slty = 1, ui = 2,
,xlab="", pt.bg=par("bg"),pch = ".",
ylab=nombre_indice,ylim = c(valor_min, valor_max),
axes=F)
lines(x,y, col = 2,lwd = 2)
lines(x,indice,col = 4,lwd = 2)
if(!is.null(valor_crucero)){
points(length(tiempo),valor_crucero, col = 1,pch = 16)
}
axis(1,at=1:length(tiempo),labels=substring(tiempo, 1,7),las=2,cex.axis=1,tcl = -0.2,hadj = 0.8)
axis(1,at=1:length(time),labels=FALSE,tcl = -0.5)
abline(v = which(substring(tiempo,6,7) %in% "01"), col = 1, lty = 2)
axis(2)
box()
if(is.null(nombre_indice_legenda)){
nombre_indice_legenda <- nombre_indice
}
if(is.null(nombre_patron)){
nombre_patron <- "Patrón"
}
if(is.null(nombre_crucero)){
legend("toprigh",c(nombre_patron, nombre_indice_legenda), lty = c(1,1), lwd = c(2,2),col = c(2,4),bty = "n")
}else{
legend("toprigh",c(nombre_patron, nombre_indice_legenda, nombre_crucero), lty = c(1,1,0), lwd = c(2,2,NA),pch = c(NA,NA,16), col = c(2,4,1),bty = "n")
}
}
plot_repro(tiempo = data$fecha, indice = data$FC, patron = data$FC_PATRON, sd_patron = data$FC_SD, valor_crucero = NULL,
nombre_indice = "FC", nombre_indice_legenda = "FC", nombre_patron = "Patrón", nombre_crucero = NULL)
data
getwd()
save(data, file = "D:/github/fenix/data/dataRepro.RData")
dataRepro <- read.csv("D:/2018/Cr_180204/datos/indices_reproductivos/data_ejemplo.csv")
save(dataRepro, file = "D:/github/fenix/data/dataRepro.RData")
library(fenix)
dataRepro
library(fenix)
library(fenix)
library(fenix)
library(fenix)
library(fenix)
library(fenix)
library(fenix)
library(fenix)
library(fenix)
dataRepro
dataRepro
dataRepro
data(dataRepro)
dataRepro
dataRepro$fecha
as.Date(dataRepro$fecha, format = "%d/%m/%Y")
dataRepro$fecha <- as.Date(dataRepro$fecha, format = "%d/%m/%Y")
plot_repro(tiempo = dataRepro$fecha, indice = dataRepro$IGS, patron = dataRepro$IGS_PATRON, sd_patron = dataRepro$IGS_SD, valor_crucero = 5,
nombre_indice = "Índice gonodosomático (IGS)", nombre_indice_legenda = "IGS", nombre_patron = "Patrón", nombre_crucero = "Cr_1802_04")
library(fenix)
library(fenix)
library(fenix)
library(fenix)
Encoding("TomÃ¡Å¡ RosickÃ½")
library(fenix)
library(fenix)
head(dataReproRepro)
dataRepro$fecha <- as.Date(dataRepro$fecha, format = "%d/%m/%Y")
plot_repro(tiempo = dataRepro$fecha, indice = dataRepro$IGS, patron = dataRepro$IGS_PATRON, sd_patron = dataRepro$IGS_SD, valor_crucero = 5,
nombre_indice = "Ãndice gonodosomÃ¡tico (IGS)", nombre_indice_legenda = "IGS", nombre_patron = "Patron", nombre_crucero = "Cr_1802_04")
library(fenix)
library(fenix)
library(fenix)
par(mfrow = c(3,1))
plot_repro(tiempo = dataRepro$fecha, indice = dataRepro$IGS, patron = dataRepro$IGS_PATRON, sd_patron = dataRepro$IGS_SD, valor_crucero = 5,
nombre_indice = "IGS", nombre_indice_legenda = "IGS", nombre_patron = "Patron", nombre_crucero = "Cr_1802_04", axis_x = FALSE)
legend("topleft", legend = "a)",bty = "n")
plot_repro(tiempo = dataRepro$fecha, indice = dataRepro$FD, patron = dataRepro$FD_PATRON, sd_patron = dataRepro$FD_SD, valor_crucero = NULL,
nombre_indice = "FD", nombre_indice_legenda = "FD", nombre_patron = "Patron", nombre_crucero = NULL, axis_x = FALSE)
legend("topleft", legend = "b)",bty = "n")
plot_repro(tiempo = dataRepro$fecha, indice = dataRepro$IA, patron = dataRepro$IA_PATRON, sd_patron = dataRepro$IA_SD, valor_crucero = NULL,
nombre_indice = "IA", nombre_indice_legenda = "IA", nombre_patron = "Patron", nombre_crucero = NULL)
matrix(c(1,1,1), 3, 1, byrow = TRUE)
layout(matrix(c(1,1,1), 3, 1, byrow = TRUE), heights = c(0.8,0.8,1))
par(mar = c(0,4,0,0))
plot_repro(tiempo = dataRepro$fecha, indice = dataRepro$IGS, patron = dataRepro$IGS_PATRON, sd_patron = dataRepro$IGS_SD, valor_crucero = 5,
nombre_indice = "IGS", nombre_indice_legenda = "IGS", nombre_patron = "Patron", nombre_crucero = "Cr_1802_04", axis_x = FALSE)
legend("topleft", legend = "a)",bty = "n")
par(mar = c(0,4,0,0))
plot_repro(tiempo = dataRepro$fecha, indice = dataRepro$FD, patron = dataRepro$FD_PATRON, sd_patron = dataRepro$FD_SD, valor_crucero = NULL,
nombre_indice = "FD", nombre_indice_legenda = "FD", nombre_patron = "Patron", nombre_crucero = NULL, axis_x = FALSE)
legend("topleft", legend = "b)",bty = "n")
par(mar = c(4,4,0,0))
plot_repro(tiempo = dataRepro$fecha, indice = dataRepro$IA, patron = dataRepro$IA_PATRON, sd_patron = dataRepro$IA_SD, valor_crucero = NULL,
nombre_indice = "IA", nombre_indice_legenda = "IA", nombre_patron = "Patron", nombre_crucero = NULL)
layout(matrix(c(1,1,1), 3, 1, byrow = TRUE), heights = c(0.8,0.8,1))
m <- layout(matrix(c(1,1,1), 3, 1, byrow = TRUE), heights = c(0.8,0.8,1))
layout.show(m)
m <- layout(matrix(c(1,2,3), 3, 1, byrow = TRUE), heights = c(0.8,0.8,1))
layout.show(m)
par(mar = c(0,4,0,0))
plot_repro(tiempo = dataRepro$fecha, indice = dataRepro$IGS, patron = dataRepro$IGS_PATRON, sd_patron = dataRepro$IGS_SD, valor_crucero = 5,
nombre_indice = "IGS", nombre_indice_legenda = "IGS", nombre_patron = "Patron", nombre_crucero = "Cr_1802_04", axis_x = FALSE)
legend("topleft", legend = "a)",bty = "n")
par(mar = c(0,4,0,0))
plot_repro(tiempo = dataRepro$fecha, indice = dataRepro$FD, patron = dataRepro$FD_PATRON, sd_patron = dataRepro$FD_SD, valor_crucero = NULL,
nombre_indice = "FD", nombre_indice_legenda = "FD", nombre_patron = "Patron", nombre_crucero = NULL, axis_x = FALSE)
legend("topleft", legend = "b)",bty = "n")
par(mar = c(4,4,0,0))
plot_repro(tiempo = dataRepro$fecha, indice = dataRepro$IA, patron = dataRepro$IA_PATRON, sd_patron = dataRepro$IA_SD, valor_crucero = NULL,
nombre_indice = "IA", nombre_indice_legenda = "IA", nombre_patron = "Patron", nombre_crucero = NULL)
par(mar = c(0.5,4,0,0))
plot_repro(tiempo = dataRepro$fecha, indice = dataRepro$IGS, patron = dataRepro$IGS_PATRON, sd_patron = dataRepro$IGS_SD, valor_crucero = 5,
nombre_indice = "IGS", nombre_indice_legenda = "IGS", nombre_patron = "Patron", nombre_crucero = "Cr_1802_04", axis_x = FALSE)
legend("topleft", legend = "a)",bty = "n")
par(mar = c(0.5,4,0,0))
plot_repro(tiempo = dataRepro$fecha, indice = dataRepro$FD, patron = dataRepro$FD_PATRON, sd_patron = dataRepro$FD_SD, valor_crucero = NULL,
nombre_indice = "FD", nombre_indice_legenda = "FD", nombre_patron = "Patron", nombre_crucero = NULL, axis_x = FALSE)
legend("topleft", legend = "b)",bty = "n")
par(mar = c(4,4,0,0))
plot_repro(tiempo = dataRepro$fecha, indice = dataRepro$IA, patron = dataRepro$IA_PATRON, sd_patron = dataRepro$IA_SD, valor_crucero = NULL,
nombre_indice = "IA", nombre_indice_legenda = "IA", nombre_patron = "Patron", nombre_crucero = NULL)
layout(matrix(c(1,2,3), 3, 1, byrow = TRUE), heights = c(0.9,0.9,1))
par(mar = c(0.5,4,0,0))
plot_repro(tiempo = dataRepro$fecha, indice = dataRepro$IGS, patron = dataRepro$IGS_PATRON, sd_patron = dataRepro$IGS_SD, valor_crucero = 5,
nombre_indice = "IGS", nombre_indice_legenda = "IGS", nombre_patron = "Patron", nombre_crucero = "Cr_1802_04", axis_x = FALSE)
legend("topleft", legend = "a)",bty = "n")
par(mar = c(0.5,4,0,0))
plot_repro(tiempo = dataRepro$fecha, indice = dataRepro$FD, patron = dataRepro$FD_PATRON, sd_patron = dataRepro$FD_SD, valor_crucero = NULL,
nombre_indice = "FD", nombre_indice_legenda = "FD", nombre_patron = "Patron", nombre_crucero = NULL, axis_x = FALSE)
legend("topleft", legend = "b)",bty = "n")
par(mar = c(4,4,0,0))
plot_repro(tiempo = dataRepro$fecha, indice = dataRepro$IA, patron = dataRepro$IA_PATRON, sd_patron = dataRepro$IA_SD, valor_crucero = NULL,
nombre_indice = "IA", nombre_indice_legenda = "IA", nombre_patron = "Patron", nombre_crucero = NULL)
library(fenix)
layout(matrix(c(1,2,3), 3, 1, byrow = TRUE), heights = c(0.9,0.9,1))
par(mar = c(0.5,4,0,0))
plot_repro(tiempo = dataRepro$fecha, indice = dataRepro$IGS, patron = dataRepro$IGS_PATRON, sd_patron = dataRepro$IGS_SD, valor_crucero = 5,
nombre_indice = "IGS", nombre_indice_legenda = "IGS", nombre_patron = "Patron", nombre_crucero = "Cr_1802_04", axis_x = FALSE)
legend("topleft", legend = "a)",bty = "n")
par(mar = c(0.5,4,0,0))
plot_repro(tiempo = dataRepro$fecha, indice = dataRepro$FD, patron = dataRepro$FD_PATRON, sd_patron = dataRepro$FD_SD, valor_crucero = NULL,
nombre_indice = "FD", nombre_indice_legenda = "FD", nombre_patron = "Patron", nombre_crucero = NULL, axis_x = FALSE)
legend("topleft", legend = "b)",bty = "n")
par(mar = c(4,4,0,0))
plot_repro(tiempo = dataRepro$fecha, indice = dataRepro$IA, patron = dataRepro$IA_PATRON, sd_patron = dataRepro$IA_SD, valor_crucero = NULL,
nombre_indice = "IA", nombre_indice_legenda = "IA", nombre_patron = "Patron", nombre_crucero = NULL)
legend("topleft", legend = "c)",bty = "n")
plot_repro(tiempo = dataRepro$fecha, indice = dataRepro$IGS, patron = dataRepro$IGS_PATRON, sd_patron = dataRepro$IGS_SD, valor_crucero = 5,
nombre_indice = "IGS", nombre_indice_legenda = "IGS", nombre_patron = "Patron", nombre_crucero = "Cr_1802_04")
substring(tiempo,6,7)
dataRepro$fecha
as.Date(dataRepro$fecha, format = "\%d/\%m/\%Y")
as.Date(dataRepro$fecha, format = "%d/%m/%Y")
tt <- as.Date(dataRepro$fecha, format = "%d/%m/%Y")
tt
substring(tt,1,7)
substring(tt,6,7)
which(substring(tt,6,7) %in% "01")
dataRepro$fecha <- as.Date(dataRepro$fecha, format = "%d/%m/%Y")
par(mar = c(0.5,4,0,0))
plot_repro(tiempo = dataRepro$fecha, indice = dataRepro$IGS, patron = dataRepro$IGS_PATRON, sd_patron = dataRepro$IGS_SD, valor_crucero = 5,
nombre_indice = "IGS", nombre_indice_legenda = "IGS", nombre_patron = "Patron", nombre_crucero = "Cr_1802_04", axis_x = FALSE)
legend("topleft", legend = "a)",bty = "n")
par(mar = c(0.5,4,0,0))
plot_repro(tiempo = dataRepro$fecha, indice = dataRepro$FD, patron = dataRepro$FD_PATRON, sd_patron = dataRepro$FD_SD, valor_crucero = NULL,
nombre_indice = "FD", nombre_indice_legenda = "FD", nombre_patron = "Patron", nombre_crucero = NULL, axis_x = FALSE)
legend("topleft", legend = "b)",bty = "n")
par(mar = c(4,4,0,0))
plot_repro(tiempo = dataRepro$fecha, indice = dataRepro$IA, patron = dataRepro$IA_PATRON, sd_patron = dataRepro$IA_SD, valor_crucero = NULL,
nombre_indice = "IA", nombre_indice_legenda = "IA", nombre_patron = "Patron", nombre_crucero = NULL)
legend("topleft", legend = "c)",bty = "n")
layout(matrix(c(1,2,3), 3, 1, byrow = TRUE), heights = c(0.9,0.9,1))
par(mar = c(0.5,4,0,0))
plot_repro(tiempo = dataRepro$fecha, indice = dataRepro$IGS, patron = dataRepro$IGS_PATRON, sd_patron = dataRepro$IGS_SD, valor_crucero = 5,
nombre_indice = "IGS", nombre_indice_legenda = "IGS", nombre_patron = "Patron", nombre_crucero = "Cr_1802_04", axis_x = FALSE)
legend("topleft", legend = "a)",bty = "n")
par(mar = c(0.5,4,0,0))
plot_repro(tiempo = dataRepro$fecha, indice = dataRepro$FD, patron = dataRepro$FD_PATRON, sd_patron = dataRepro$FD_SD, valor_crucero = NULL,
nombre_indice = "FD", nombre_indice_legenda = "FD", nombre_patron = "Patron", nombre_crucero = NULL, axis_x = FALSE)
legend("topleft", legend = "b)",bty = "n")
par(mar = c(4,4,0,0))
plot_repro(tiempo = dataRepro$fecha, indice = dataRepro$IA, patron = dataRepro$IA_PATRON, sd_patron = dataRepro$IA_SD, valor_crucero = NULL,
nombre_indice = "IA", nombre_indice_legenda = "IA", nombre_patron = "Patron", nombre_crucero = NULL)
legend("topleft", legend = "c)",bty = "n")
library(fenix)
layout(matrix(c(1,2,3), 3, 1, byrow = TRUE), heights = c(0.9,0.9,1))
par(mar = c(0.5,4,0,0))
plot_repro(tiempo = dataRepro$fecha, indice = dataRepro$IGS, patron = dataRepro$IGS_PATRON, sd_patron = dataRepro$IGS_SD, valor_crucero = 5,
nombre_indice = "IGS", nombre_indice_legenda = "IGS", nombre_patron = "Patron", nombre_crucero = "Cr_1802_04", axis_x = FALSE)
legend("topleft", legend = "a)",bty = "n")
par(mar = c(0.5,4,0,0))
plot_repro(tiempo = dataRepro$fecha, indice = dataRepro$FD, patron = dataRepro$FD_PATRON, sd_patron = dataRepro$FD_SD, valor_crucero = NULL,
nombre_indice = "FD", nombre_indice_legenda = "FD", nombre_patron = "Patron", nombre_crucero = NULL, axis_x = FALSE)
legend("topleft", legend = "b)",bty = "n")
par(mar = c(4,4,0,0))
plot_repro(tiempo = dataRepro$fecha, indice = dataRepro$IA, patron = dataRepro$IA_PATRON, sd_patron = dataRepro$IA_SD, valor_crucero = NULL,
nombre_indice = "IA", nombre_indice_legenda = "IA", nombre_patron = "Patron", nombre_crucero = NULL)
legend("topleft", legend = "c)",bty = "n")
layout(matrix(c(1,2,3), 3, 1, byrow = TRUE), heights = c(0.85,0.85,1))
par(mar = c(0.5,4,0,0))
plot_repro(tiempo = dataRepro$fecha, indice = dataRepro$IGS, patron = dataRepro$IGS_PATRON, sd_patron = dataRepro$IGS_SD, valor_crucero = 5,
nombre_indice = "IGS", nombre_indice_legenda = "IGS", nombre_patron = "Patron", nombre_crucero = "Cr_1802_04", axis_x = FALSE)
legend("topleft", legend = "a)",bty = "n")
par(mar = c(0.5,4,0,0))
plot_repro(tiempo = dataRepro$fecha, indice = dataRepro$FD, patron = dataRepro$FD_PATRON, sd_patron = dataRepro$FD_SD, valor_crucero = NULL,
nombre_indice = "FD", nombre_indice_legenda = "FD", nombre_patron = "Patron", nombre_crucero = NULL, axis_x = FALSE)
legend("topleft", legend = "b)",bty = "n")
par(mar = c(4,4,0,0))
plot_repro(tiempo = dataRepro$fecha, indice = dataRepro$IA, patron = dataRepro$IA_PATRON, sd_patron = dataRepro$IA_SD, valor_crucero = NULL,
nombre_indice = "IA", nombre_indice_legenda = "IA", nombre_patron = "Patron", nombre_crucero = NULL)
legend("topleft", legend = "c)",bty = "n")
layout(matrix(c(1,2), 3, 1, byrow = TRUE), heights = c(0.85,1))
par(mar = c(0.5,4,0,0))
plot_repro(tiempo = dataRepro$fecha, indice = dataRepro$FC, patron = dataRepro$FC_PATRON, sd_patron = dataRepro$FC_SD, valor_crucero = NULL,
nombre_indice = "FC", nombre_indice_legenda = "FC", nombre_patron = "Patron", nombre_crucero = NULL)
legend("topleft", legend = "a)",bty = "n")
par(mar = c(4,4,0,0))
plot_repro(tiempo = dataRepro$fecha, indice = dataRepro$CG, patron = dataRepro$CG_SD, sd_patron = dataRepro$CG_SD, valor_crucero = NULL,
nombre_indice = "CG", nombre_indice_legenda = "CG", nombre_patron = "Patron", nombre_crucero = NULL)
legend("topleft", legend = "b)",bty = "n")
## CONDICION SOMATICA
layout(matrix(c(1,2), 2, 1, byrow = TRUE), heights = c(0.85,1))
par(mar = c(0.5,4,0,0))
plot_repro(tiempo = dataRepro$fecha, indice = dataRepro$FC, patron = dataRepro$FC_PATRON, sd_patron = dataRepro$FC_SD, valor_crucero = NULL,
nombre_indice = "FC", nombre_indice_legenda = "FC", nombre_patron = "Patron", nombre_crucero = NULL)
legend("topleft", legend = "a)",bty = "n")
par(mar = c(4,4,0,0))
plot_repro(tiempo = dataRepro$fecha, indice = dataRepro$CG, patron = dataRepro$CG_SD, sd_patron = dataRepro$CG_SD, valor_crucero = NULL,
nombre_indice = "CG", nombre_indice_legenda = "CG", nombre_patron = "Patron", nombre_crucero = NULL)
legend("topleft", legend = "b)",bty = "n")
layout(matrix(c(1,2,3), 3, 1, byrow = TRUE), heights = c(0.85,0.85,1))
par(mar = c(0.5,4,0,0))
plot_repro(tiempo = dataRepro$fecha, indice = dataRepro$IGS, patron = dataRepro$IGS_PATRON, sd_patron = dataRepro$IGS_SD, valor_crucero = 5,
nombre_indice = "IGS", nombre_indice_legenda = "IGS", nombre_patron = "Patron", nombre_crucero = "Cr_1802_04", axis_x = FALSE)
legend("topleft", legend = "a)",bty = "n")
par(mar = c(0.5,4,0,0))
plot_repro(tiempo = dataRepro$fecha, indice = dataRepro$FD, patron = dataRepro$FD_PATRON, sd_patron = dataRepro$FD_SD, valor_crucero = NULL,
nombre_indice = "FD", nombre_indice_legenda = "FD", nombre_patron = "Patron", nombre_crucero = NULL, axis_x = FALSE)
legend("topleft", legend = "b)",bty = "n")
par(mar = c(4,4,0,0))
plot_repro(tiempo = dataRepro$fecha, indice = dataRepro$IA, patron = dataRepro$IA_PATRON, sd_patron = dataRepro$IA_SD, valor_crucero = NULL,
nombre_indice = "IA", nombre_indice_legenda = "IA", nombre_patron = "Patron", nombre_crucero = NULL)
legend("topleft", legend = "c)",bty = "n")
layout(matrix(c(1,2), 2, 1, byrow = TRUE), heights = c(0.85,1))
par(mar = c(0.5,4,0,0))
plot_repro(tiempo = dataRepro$fecha, indice = dataRepro$FC, patron = dataRepro$FC_PATRON, sd_patron = dataRepro$FC_SD, valor_crucero = NULL,
nombre_indice = "FC", nombre_indice_legenda = "FC", nombre_patron = "Patron", nombre_crucero = NULL,  axis_x = FALSE)
legend("topleft", legend = "a)",bty = "n")
par(mar = c(4,4,0,0))
plot_repro(tiempo = dataRepro$fecha, indice = dataRepro$CG, patron = dataRepro$CG_SD, sd_patron = dataRepro$CG_SD, valor_crucero = NULL,
nombre_indice = "CG", nombre_indice_legenda = "CG", nombre_patron = "Patron", nombre_crucero = NULL)
legend("topleft", legend = "b)",bty = "n")
plot_repro(tiempo = dataRepro$fecha, indice = dataRepro$FC, patron = dataRepro$FC_PATRON, sd_patron = dataRepro$FC_SD, valor_crucero = NULL,
nombre_indice = "FC", nombre_indice_legenda = "FC", nombre_patron = "Patron", nombre_crucero = NULL)
plot_repro(tiempo = dataRepro$fecha, indice = dataRepro$FC, patron = dataRepro$FC_PATRON, sd_patron = dataRepro$FC_SD, valor_crucero = NULL,
nombre_indice = "FC", nombre_indice_legenda = "FC", nombre_patron = "Patron", nombre_crucero = NULL,  axis_x = FALSE)
library(fenix)
layout(matrix(c(1,2), 2, 1, byrow = TRUE), heights = c(0.85,1))
par(mar = c(0.5,4,0,0))
plot_repro(tiempo = dataRepro$fecha, indice = dataRepro$FC, patron = dataRepro$FC_PATRON, sd_patron = dataRepro$FC_SD, valor_crucero = NULL,
nombre_indice = "FC", nombre_indice_legenda = "FC", nombre_patron = "Patron", nombre_crucero = NULL,  axis_x = FALSE)
legend("topleft", legend = "a)",bty = "n")
par(mar = c(4,4,0,0))
plot_repro(tiempo = dataRepro$fecha, indice = dataRepro$CG, patron = dataRepro$CG_SD, sd_patron = dataRepro$CG_SD, valor_crucero = NULL,
nombre_indice = "CG", nombre_indice_legenda = "CG", nombre_patron = "Patron", nombre_crucero = NULL)
legend("topleft", legend = "b)",bty = "n")
layout(matrix(c(1,2,3), 3, 1, byrow = TRUE), heights = c(0.85,0.85,1))
par(mar = c(0.5,4,0,0))
plot_repro(tiempo = dataRepro$fecha, indice = dataRepro$IGS, patron = dataRepro$IGS_PATRON, sd_patron = dataRepro$IGS_SD, valor_crucero = 5,
nombre_indice = "IGS", nombre_indice_legenda = "IGS", nombre_patron = "Patron", nombre_crucero = "Cr_1802_04", axis_x = FALSE)
legend("topleft", legend = "a)",bty = "n")
par(mar = c(0.5,4,0,0))
plot_repro(tiempo = dataRepro$fecha, indice = dataRepro$FD, patron = dataRepro$FD_PATRON, sd_patron = dataRepro$FD_SD, valor_crucero = NULL,
nombre_indice = "FD", nombre_indice_legenda = "FD", nombre_patron = "Patron", nombre_crucero = NULL, axis_x = FALSE)
legend("topleft", legend = "b)",bty = "n")
par(mar = c(4,4,0,0))
plot_repro(tiempo = dataRepro$fecha, indice = dataRepro$IA, patron = dataRepro$IA_PATRON, sd_patron = dataRepro$IA_SD, valor_crucero = NULL,
nombre_indice = "IA", nombre_indice_legenda = "IA", nombre_patron = "Patron", nombre_crucero = NULL)
legend("topleft", legend = "c)",bty = "n")
library(fenix)
getwd()
library(fenix)
library(fenix)
library(fenix)
ecos = read.csv("D:/ecos/0502-04.csv")
biom = read.csv("D:/ecos/CR. 0502-04.csv")
head(ecos)
head(biom)
require(fenix)
ecos$ANC
table(ecos$ANC == 0)
table(ecos$ANC == 0)
hist(ecos$ANC)
ecos <- ecos[ecos$ANC > 0,]
names(ecos)
x1 = ecos$LON_M
x1 = ecos$LAT_M
x1 = ecos$LON_M
y1 = ecos$LAT_M
biom$LATITUD_INICIAL
x = biom$LONGITUD_INICIAL
y = biom$LATITUD_INICIAL
x1
y1
plot(x1, y1, col = 2)
points(x, y, col = 4)
estima_distance_nasc <- function (x, y, x1, y1)
{
A3 = y1 * pi/180
B3 = x1 * pi/180
A31 = y * pi/180
B31 = x * pi/180
num2 = length(x1) - 1
n = length(x)
dfinal = NULL
num = length(y)
pos.na = c(which(is.na(y) == TRUE), which(is.na(x) == TRUE))
pos.na
dc <- NULL
num2 = length(x1) - 1
n = length(x)
dfinal = NULL
num = length(y)
pos.na = c(which(is.na(y) == TRUE), which(is.na(x) == TRUE))
pos.na
d1 <- NULL
d2 <- NULL
for(i in 1:num){
A=NULL
B=NULL
A=sin(A3[1:num2]) * sin(A31[i])
B=cos(A3[1:num2]) * cos(A31[i])*cos(B3[1:num2]-B31[i])
grad=acos(A+B)
gradinrad=180*grad/pi
distancia=(60*gradinrad)
indnonan=which(distancia>0)
if(length(indnonan) == 0){
dist_min = NA
}else{
dist_min1=which.min(distancia[indnonan])
dist0 = distancia[indnonan]
dist_min2=which.min(dist0[-which.min(dist0)])
}
d1 <- rbind(d1,dist_min1)
d2 <- rbind(d2,dist_min2)
}
d1 <- as.numeric(d1)
suppressWarnings(d1)
d2 <- as.numeric(d2)
suppressWarnings(d2)
d0 <- cbind(d1, d2)
return(d0)
}
x1 = ecos$LON_M
y1 = ecos$LAT_M
x = biom$LONGITUD_INICIAL
y = biom$LATITUD_INICIAL
d <- estima_distance_nasc(x, y, x1, y1)
d
i = 1
d[i,]
as.numeric(d[i,]  )
ecos[as.numeric(d[i,]),]
ecos[as.numeric(d[i,]),"ANC"]
mean(ecos[as.numeric(d[i,]),"ANC"])
dim(biom)
dim(d)
biom$eco <- NA
for(i in 1:length(d[,1])){
biom$eco[i] <- mean(ecos[as.numeric(d[i,]),"ANC"])
}
biom$eco
head(biom)
library(fenix)
estima_distance_nasc
