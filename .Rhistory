sigma = out_modas$outL$sigma[i]
cohortei = cohort_to_length(cohort = c(N, mu, sigma), lower = 5, upper = 20)
cohorte_all = rbind(cohorte_all, cohortei)
}
data_modas <- data.frame(id = jj, population = out_modas$tableBhatt$Population, mean = out_modas$tableBhatt$Mean, sigma = out_modas$outL$sigma)
data_modas <- cbind(data_modas, cohorte_all)
}
}
modas
modas[!is.na(modas)]
modas[jj]
modas[jj,]
na.omit(modas[jj,])
na.omit(modas[jj,])[1]
na.omit(modas[jj,])
str(na.omit(modas[jj,]))
modas[jj,][!is.na(modas[jj,])]
out_modas = Bhattacharya(frequency_catch, groups = data_length$num_modas[jj], mu = modas[jj,][!is.na(modas[jj,])])
modas[jj,][!is.na(modas[jj,])]
data_length$num_modas[jj]
frequency_catch
data_length$num_modas[jj]
modas[jj,][!is.na(modas[jj,])]
frequency_catch
plot(frequency_catch, type = "l", lwd = 2)
plot(frequency_catch, type = "l", lwd = 4)
out_modas = Bhattacharya(frequency_catch, groups = data_length$num_modas[jj], mu = modas[jj,][!is.na(modas[jj,])])
Bhattacharya
Bhattacharya = function(x, length_class = seq(5, 20, by = 0.5), groups, mu = NULL, maxit = 5000){
list.of.packages <- c("mixtools")
new.packages <- list.of.packages[!(list.of.packages %in% installed.packages()[,"Package"])]
if(length(new.packages)) install.packages(new.packages)
library(mixtools)
x[is.na(x)] = 0
matriz = as.data.frame(cbind(length_class, x))
outL = tryCatch({
normalmixEM(rep(matriz$length_class, matriz$x), k = groups, mu = mu, maxit = maxit)
}, error=function(e) {
message("Not Converge")
outL <- NULL
return(outL)
})
if(!is.null(outL)){
population = sum(x)*outL$lambda
tableBhatt = data.frame(Group = seq_along(outL$mu), Mean = outL$mu, Population = population)
plot(outL, which = 2)
box()
out = list(tableBhatt = tableBhatt, outL = outL)
}else{
out = NULL
}
return(out)
}
Bhattacharya
out_modas = Bhattacharya(frequency_catch, groups = data_length$num_modas[jj], mu = modas[jj,][!is.na(modas[jj,])])
cohorte_all <- NULL
for(jj in 1:length(data_length$num_modas)){
frequency_catch = weighted_frequency(length = seq(5, 20, by = 0.5), frequency = as.numeric(data_length[jj,estructura]), a = 0.003925, b = 3.2178, catch =  as.numeric(data_length[jj,"catch"])*1000)
out_modas = Bhattacharya(frequency_catch, groups = data_length$num_modas[jj], mu = modas[jj,][!is.na(modas[jj,])])
if(!is.null(out_modas)){
cohorte_all <- NULL
for(i in 1:length(out_modas$tableBhatt$Population)){
N = out_modas$tableBhatt$Population[i]
mu = out_modas$tableBhatt$Mean[i]
sigma = out_modas$outL$sigma[i]
cohortei = cohort_to_length(cohort = c(N, mu, sigma), lower = 5, upper = 20)
cohorte_all = rbind(cohorte_all, cohortei)
}
data_modas <- data.frame(id = jj, population = out_modas$tableBhatt$Population, mean = out_modas$tableBhatt$Mean, sigma = out_modas$outL$sigma)
data_modas <- cbind(data_modas, cohorte_all)
}
}
out_modas$outL
cohorte_all
cohorte_all
cohorte_all
for(jj in 1:length(data_length$num_modas)){
frequency_catch = weighted_frequency(length = seq(5, 20, by = 0.5), frequency = as.numeric(data_length[jj,estructura]), a = 0.003925, b = 3.2178, catch =  as.numeric(data_length[jj,"catch"])*1000)
out_modas = Bhattacharya(frequency_catch, groups = data_length$num_modas[jj], mu = modas[jj,][!is.na(modas[jj,])])
if(!is.null(out_modas)){
cohorteii <- NULL
for(i in 1:length(out_modas$tableBhatt$Population)){
N = out_modas$tableBhatt$Population[i]
mu = out_modas$tableBhatt$Mean[i]
sigma = out_modas$outL$sigma[i]
cohortei = cohort_to_length(cohort = c(N, mu, sigma), lower = 5, upper = 20)
cohorteii = rbind(cohorteii, cohortei)
}
data_modas <- data.frame(id = jj, population = out_modas$tableBhatt$Population, mean = out_modas$tableBhatt$Mean, sigma = out_modas$outL$sigma)
data_modas <- cbind(data_modas, cohorte_all)
}
}
data_modas
for(jj in 1:length(data_length$num_modas)){
frequency_catch = weighted_frequency(length = seq(5, 20, by = 0.5), frequency = as.numeric(data_length[jj,estructura]), a = 0.003925, b = 3.2178, catch =  as.numeric(data_length[jj,"catch"])*1000)
out_modas = Bhattacharya(frequency_catch, groups = data_length$num_modas[jj], mu = modas[jj,][!is.na(modas[jj,])])
if(!is.null(out_modas)){
cohorteii <- NULL
for(i in 1:length(out_modas$tableBhatt$Population)){
N = out_modas$tableBhatt$Population[i]
mu = out_modas$tableBhatt$Mean[i]
sigma = out_modas$outL$sigma[i]
cohortei = cohort_to_length(cohort = c(N, mu, sigma), lower = 5, upper = 20)
cohorteii = rbind(cohorteii, cohortei)
}
data_modasjj <- data.frame(id = jj, population = out_modas$tableBhatt$Population, mean = out_modas$tableBhatt$Mean, sigma = out_modas$outL$sigma)
data_modasjj <- cbind(data_modasjj, cohorte_all)
}
data_moda <- rbind(data_moda, data_modajj)
}
data_moda <- NULL
for(jj in 1:length(data_length$num_modas)){
frequency_catch = weighted_frequency(length = seq(5, 20, by = 0.5), frequency = as.numeric(data_length[jj,estructura]), a = 0.003925, b = 3.2178, catch =  as.numeric(data_length[jj,"catch"])*1000)
out_modas = Bhattacharya(frequency_catch, groups = data_length$num_modas[jj], mu = modas[jj,][!is.na(modas[jj,])])
if(!is.null(out_modas)){
cohorteii <- NULL
for(i in 1:length(out_modas$tableBhatt$Population)){
N = out_modas$tableBhatt$Population[i]
mu = out_modas$tableBhatt$Mean[i]
sigma = out_modas$outL$sigma[i]
cohortei = cohort_to_length(cohort = c(N, mu, sigma), lower = 5, upper = 20)
cohorteii = rbind(cohorteii, cohortei)
}
data_modasjj <- data.frame(id = jj, population = out_modas$tableBhatt$Population, mean = out_modas$tableBhatt$Mean, sigma = out_modas$outL$sigma)
data_modasjj <- cbind(data_modasjj, cohorte_all)
}
data_moda <- rbind(data_moda, data_modajj)
}
data_modas <- NULL
for(jj in 1:length(data_length$num_modas)){
frequency_catch = weighted_frequency(length = seq(5, 20, by = 0.5), frequency = as.numeric(data_length[jj,estructura]), a = 0.003925, b = 3.2178, catch =  as.numeric(data_length[jj,"catch"])*1000)
out_modas = Bhattacharya(frequency_catch, groups = data_length$num_modas[jj], mu = modas[jj,][!is.na(modas[jj,])])
if(!is.null(out_modas)){
cohorteii <- NULL
for(i in 1:length(out_modas$tableBhatt$Population)){
N = out_modas$tableBhatt$Population[i]
mu = out_modas$tableBhatt$Mean[i]
sigma = out_modas$outL$sigma[i]
cohortei = cohort_to_length(cohort = c(N, mu, sigma), lower = 5, upper = 20)
cohorteii = rbind(cohorteii, cohortei)
}
data_modasjj <- data.frame(id = jj, population = out_modas$tableBhatt$Population, mean = out_modas$tableBhatt$Mean, sigma = out_modas$outL$sigma)
data_modasjj <- cbind(data_modasjj, cohorte_all)
}
data_modas <- rbind(data_modas, data_modasjj)
}
data_modas
data_modas <- NULL
for(jj in 1:length(data_length$num_modas)){
out_modas <- NULL
frequency_catch = weighted_frequency(length = seq(5, 20, by = 0.5), frequency = as.numeric(data_length[jj,estructura]), a = 0.003925, b = 3.2178, catch =  as.numeric(data_length[jj,"catch"])*1000)
out_modas = Bhattacharya(frequency_catch, groups = data_length$num_modas[jj], mu = modas[jj,][!is.na(modas[jj,])])
if(!is.null(out_modas)){
cohorteii <- NULL
for(i in 1:length(out_modas$tableBhatt$Population)){
N = out_modas$tableBhatt$Population[i]
mu = out_modas$tableBhatt$Mean[i]
sigma = out_modas$outL$sigma[i]
cohortei = cohort_to_length(cohort = c(N, mu, sigma), lower = 5, upper = 20)
cohorteii = rbind(cohorteii, cohortei)
}
data_modasjj <- data.frame(id = jj, population = out_modas$tableBhatt$Population, mean = out_modas$tableBhatt$Mean, sigma = out_modas$outL$sigma)
data_modasjj <- cbind(data_modasjj, cohorte_all)
}
data_modas <- rbind(data_modas, data_modasjj)
}
data_modas
length(data_length$num_modas)
jj
jj = 1
frequency_catch = weighted_frequency(length = seq(5, 20, by = 0.5), frequency = as.numeric(data_length[jj,estructura]), a = 0.003925, b = 3.2178, catch =  as.numeric(data_length[jj,"catch"])*1000)
out_modas = Bhattacharya(frequency_catch, groups = data_length$num_modas[jj], mu = modas[jj,][!is.na(modas[jj,])])
if(!is.null(out_modas)){
cohorteii <- NULL
for(i in 1:length(out_modas$tableBhatt$Population)){
N = out_modas$tableBhatt$Population[i]
mu = out_modas$tableBhatt$Mean[i]
sigma = out_modas$outL$sigma[i]
cohortei = cohort_to_length(cohort = c(N, mu, sigma), lower = 5, upper = 20)
cohorteii = rbind(cohorteii, cohortei)
}
data_modasjj <- data.frame(id = jj, population = out_modas$tableBhatt$Population, mean = out_modas$tableBhatt$Mean, sigma = out_modas$outL$sigma)
data_modasjj <- cbind(data_modasjj, cohorte_all)
data_modasjj
cohorteii
data_modasjj <- data.frame(id = jj, population = out_modas$tableBhatt$Population, mean = out_modas$tableBhatt$Mean, sigma = out_modas$outL$sigma)
data_modasjj
data_modasjj <- cbind(data_modasjj, cohorte_all)
data_modasjj
data_modas <- NULL
data_modas <- NULL
for(jj in 1:length(data_length$num_modas)){
out_modas <- NULL
frequency_catch = weighted_frequency(length = seq(5, 20, by = 0.5), frequency = as.numeric(data_length[jj,estructura]), a = 0.003925, b = 3.2178, catch =  as.numeric(data_length[jj,"catch"])*1000)
out_modas = Bhattacharya(frequency_catch, groups = data_length$num_modas[jj], mu = modas[jj,][!is.na(modas[jj,])])
if(!is.null(out_modas)){
cohorteii <- NULL
for(i in 1:length(out_modas$tableBhatt$Population)){
N = out_modas$tableBhatt$Population[i]
mu = out_modas$tableBhatt$Mean[i]
sigma = out_modas$outL$sigma[i]
cohortei = cohort_to_length(cohort = c(N, mu, sigma), lower = 5, upper = 20)
cohorteii = rbind(cohorteii, cohortei)
}
data_modasjj <- data.frame(id = jj, population = out_modas$tableBhatt$Population, mean = out_modas$tableBhatt$Mean, sigma = out_modas$outL$sigma)
data_modasjj <- cbind(data_modasjj, cohorte_all)
}
data_modas <- rbind(data_modas, data_modasjj)
}
data_modas
frequency_catch = weighted_frequency(length = seq(5, 20, by = 0.5), frequency = as.numeric(data_length[jj,estructura]), a = 0.003925, b = 3.2178, catch =  as.numeric(data_length[jj,"catch"])*1000)
out_modas = Bhattacharya(frequency_catch, groups = data_length$num_modas[jj], mu = modas[jj,][!is.na(modas[jj,])])
out_modas
length(out_modas$tableBhatt$Population
)
1:length(out_modas$tableBhatt$Population)
1:length(out_modas$tableBhatt$Population)
out_modas$tableBhatt$Population[i]
jj = 1
out_modas <- NULL
frequency_catch = weighted_frequency(length = seq(5, 20, by = 0.5), frequency = as.numeric(data_length[jj,estructura]), a = 0.003925, b = 3.2178, catch =  as.numeric(data_length[jj,"catch"])*1000)
out_modas = Bhattacharya(frequency_catch, groups = data_length$num_modas[jj], mu = modas[jj,][!is.na(modas[jj,])])
if(!is.null(out_modas)){
cohorteii <- NULL
for(i in 1:length(out_modas$tableBhatt$Population)){
N = out_modas$tableBhatt$Population[i]
mu = out_modas$tableBhatt$Mean[i]
sigma = out_modas$outL$sigma[i]
cohortei = cohort_to_length(cohort = c(N, mu, sigma), lower = 5, upper = 20)
cohorteii = rbind(cohorteii, cohortei)
}
cohorteii
cohorteii <- NULL
for(i in 1:length(out_modas$tableBhatt$Population)){
N = out_modas$tableBhatt$Population[i]
mu = out_modas$tableBhatt$Mean[i]
sigma = out_modas$outL$sigma[i]
cohortei = cohort_to_length(cohort = c(N, mu, sigma), lower = 5, upper = 20)
cohorteii = rbind(cohorteii, cohortei)
}
cohorteii
jj = 2
frequency_catch = weighted_frequency(length = seq(5, 20, by = 0.5), frequency = as.numeric(data_length[jj,estructura]), a = 0.003925, b = 3.2178, catch =  as.numeric(data_length[jj,"catch"])*1000)
out_modas = Bhattacharya(frequency_catch, groups = data_length$num_modas[jj], mu = modas[jj,][!is.na(modas[jj,])])
cohorteii <- NULL
for(i in 1:length(out_modas$tableBhatt$Population)){
N = out_modas$tableBhatt$Population[i]
mu = out_modas$tableBhatt$Mean[i]
sigma = out_modas$outL$sigma[i]
cohortei = cohort_to_length(cohort = c(N, mu, sigma), lower = 5, upper = 20)
cohorteii = rbind(cohorteii, cohortei)
}
cohorteii
data_modas <- NULL
for(jj in 1:length(data_length$num_modas)){
out_modas <- NULL
frequency_catch = weighted_frequency(length = seq(5, 20, by = 0.5), frequency = as.numeric(data_length[jj,estructura]), a = 0.003925, b = 3.2178, catch =  as.numeric(data_length[jj,"catch"])*1000)
out_modas = Bhattacharya(frequency_catch, groups = data_length$num_modas[jj], mu = modas[jj,][!is.na(modas[jj,])])
if(!is.null(out_modas)){
cohorteii <- NULL
for(i in 1:length(out_modas$tableBhatt$Population)){
N = out_modas$tableBhatt$Population[i]
mu = out_modas$tableBhatt$Mean[i]
sigma = out_modas$outL$sigma[i]
cohortei = cohort_to_length(cohort = c(N, mu, sigma), lower = 5, upper = 20)
cohorteii = rbind(cohorteii, cohortei)
}
data_modasjj <- data.frame(id = jj, population = out_modas$tableBhatt$Population, mean = out_modas$tableBhatt$Mean, sigma = out_modas$outL$sigma)
data_modasjj <- cbind(data_modasjj, cohorteii)
}
data_modas <- rbind(data_modas, data_modasjj)
}
data_modas
data_modas
head(data_modas)
cohorteii
names.row(cohorteii)
row.names(cohorteii)
row.names(cohorteii) <- NULL
data_modas <- NULL
for(jj in 1:length(data_length$num_modas)){
out_modas <- NULL
frequency_catch = weighted_frequency(length = seq(5, 20, by = 0.5), frequency = as.numeric(data_length[jj,estructura]), a = 0.003925, b = 3.2178, catch =  as.numeric(data_length[jj,"catch"])*1000)
out_modas = Bhattacharya(frequency_catch, groups = data_length$num_modas[jj], mu = modas[jj,][!is.na(modas[jj,])])
if(!is.null(out_modas)){
cohorteii <- NULL
for(i in 1:length(out_modas$tableBhatt$Population)){
N = out_modas$tableBhatt$Population[i]
mu = out_modas$tableBhatt$Mean[i]
sigma = out_modas$outL$sigma[i]
cohortei = cohort_to_length(cohort = c(N, mu, sigma), lower = 5, upper = 20)
cohorteii = rbind(cohorteii, cohortei)
}
row.names(cohorteii) <- NULL
data_modasjj <- data.frame(id = jj, population = out_modas$tableBhatt$Population, mean = out_modas$tableBhatt$Mean, sigma = out_modas$outL$sigma)
data_modasjj <- cbind(data_modasjj, cohorteii)
}
data_modas <- rbind(data_modas, data_modasjj)
}
8*12
data_modas
row(data_modas)
nrow(data_modas)
names(data_modas)
plot(data_modas[1,5:35], type = "l")
data_modas[1,5:35]
plot(as.numeric(data_modas[1,5:35]), type = "l")
lines(as.numeric(data_modas[2,5:35]))
plot(as.numeric(data_modas[1,5:35]), type = "l", ylim = c(0,2000))
lines(as.numeric(data_modas[2,5:35]))
plot(as.numeric(data_modas[1,5:35]), type = "l", ylim = c(0,4000))
lines(as.numeric(data_modas[2,5:35]))
frequency_catch
jj = 1
frequency_catch = weighted_frequency(length = seq(5, 20, by = 0.5), frequency = as.numeric(data_length[jj,estructura]), a = 0.003925, b = 3.2178, catch =  as.numeric(data_length[jj,"catch"])*1000)
frequency_catch
lines(frequency_catch, col = 2)
plot(as.numeric(data_modas[1,5:35]), type = "l", ylim = c(0,4000))
lines(as.numeric(data_modas[2,5:35]))
seguimiento
data_length
data_length
data_length
library(fenix)
library(fenix)
head(data_length)
head(data_length)
modas
frequency_catch
data_length
modas
data_length
modas = modas(data_length[,estructura], Lmin = 5, Lmax = 20, dL = 0.5, umbral = 10)
modas
modas
data_length[,estructura]
frequency_catch
as.numeric(data_length[jj,estructura])
plot(as.numeric(data_length[jj,estructura]), type = "l")
plot(as.numeric(data_length[2,estructura]), type = "l")
as.numeric(data_length[2,estructura])
sample_frequency <- c(0,0,0,0,0,0,0,0,0,2,7,14,22,15,13,12,17,22,35,28,7,4,1,0,0,0,0,0,0,0,0)
modas(sample_frequency, Lmin = 5, Lmax = 20, dL = 0.5, umbral = 10)
sample_frequency <- c(0,0,0,0,0,0,0,0,0,2,7,14,22,15,13,12,17,22,35,28,7,4,1,0,0,0,0,0,0,0,0)
modas(as.matrix(sample_frequency), Lmin = 5, Lmax = 20, dL = 0.5, umbral = 10)
modas(matrix(sample_frequency, nrow = 1), Lmin = 5, Lmax = 20, dL = 0.5, umbral = 10)
vmodas <- modas(matrix(sample_frequency, nrow = 1), Lmin = 5, Lmax = 20, dL = 0.5, umbral = 10)
vmodas
view_modas <- modas(matrix(sample_frequency, nrow = 1), Lmin = 5, Lmax = 20, dL = 0.5, umbral = 10)
view_modas
catch_frequency = weighted_frequency(length = seq(5, 20, by = 0.5), frequency = as.numeric(data_length[jj,estructura]), a = 0.003925, b = 3.2178, catch =  as.numeric(data_length[jj,"catch"])*1000)
catch_frequency = weighted_frequency(length = seq(5, 20, by = 0.5), frequency = sample_frequency, a = 0.003925, b = 3.2178, catch =  5000)
catch_frequency
catch_frequency = weighted_frequency(length = seq(5, 20, by = 0.5), frequency = sample_frequency, a = 0.003925, b = 3.2178, catch =  50000)
catch_frequency
unique_modas <- function(x){
return(length(x[!is.na(x)]))
}
num_modas = apply(view_modas, 1, unique_modas)
num_modas
view_modas
catch_frequency = weighted_frequency(length = seq(5, 20, by = 0.5), frequency = sample_frequency, a = 0.003925, b = 3.2178, catch =  50000)
out_modas = Bhattacharya(x = catch_frequency, groups = num_modas)
N = out_modas$tableBhatt$Population
mu = out_modas$tableBhatt$Mean
sigma = out_modas$outL$sigma
cohortes <- NULL
for(i in 1:length(out_modas$tableBhatt$Population)){
N = out_modas$tableBhatt$Population
mu = out_modas$tableBhatt$Mean
sigma = out_modas$outL$sigma
cohortei = cohort_to_length(cohort = c(N, mu, sigma), lower = 5, upper = 20)
cohortes = rbind(cohortes, cohortei)
}
cohortes <- NULL
for(i in 1:length(out_modas$tableBhatt$Population)){
N = out_modas$tableBhatt$Population[i]
mu = out_modas$tableBhatt$Mean[i]
sigma = out_modas$outL$sigma[i]
cohortei = cohort_to_length(cohort = c(N, mu, sigma), lower = 5, upper = 20)
cohortes = rbind(cohortes, cohortei)
}
cohortes
# Sample
sample_frequency <- c(0,0,0,0,0,0,0,0,0,2,7,14,22,15,13,12,17,22,35,28,7,4,1,0,0,0,0,0,0,0,0)
length <- seq(5,20, by = 20)
plot(length, catch_frequency, lwd = 2, col = 4)
length <- seq(5,20, by = 20)
plot(length, catch_frequency, lwd = 2, col = 4)
# Weighted
catch_frequency = weighted_frequency(length = length, frequency = sample_frequency, a = 0.003925, b = 3.2178, catch =  50000)
plot(length, catch_frequency, lwd = 2, col = 4)
length <- seq(5,20, by = 0.5)
plot(length, catch_frequency, lwd = 2, col = 4)
plot(length, catch_frequency, type = "l", lwd = 2, col = 4)
plot(length, catch_frequency, type = "l", lwd = 2, col = 4, ylab = "Catch", xlab = "Length (cm)")
plot(length, catch_frequency, type = "l", lwd = 2, col = 4, ylab = "Catch (kg)", xlab = "Length (cm)")
# Bhattacharya
out_modas = Bhattacharya(x = catch_frequency, groups = num_modas)
num_modas
view_modas
modas <- function(Length, Lmin, Lmax, dL, umbral = 10){
moda=NULL
for(i in 1:length(Length[,1])){
vector <- as.numeric(Length[i,])
moda0  <- which(diff(sign(diff(vector)))==-2)+1
if(length(vector[moda0]) > 1){
for(i in 1:length(vector[moda0])){
if(vector[moda0[i]] < umbral){
moda0[i] = NA
}
}
}
moda0  <- moda0[!is.na(moda0)]
Lmoda0 <- seq(Lmin,Lmax,by=dL)[moda0]
Lmoda0 <- Lmoda0[order(vector[moda0], decreasing=TRUE)]
Lmoda0 <- c(Lmoda0,rep(NA,10-length(moda0)))
moda   <- rbind(moda,Lmoda0)
}
row.names(moda) <- NULL
return(moda)
}
# Sample
sample_frequency <- c(0,0,0,0,0,0,0,0,0,2,7,14,22,15,13,12,17,22,35,28,7,4,1,0,0,0,0,0,0,0,0)
length <- seq(5,20, by = 0.5)
view_modas <- modas(matrix(sample_frequency, nrow = 1), Lmin = 5, Lmax = 20, dL = 0.5, umbral = 10)
unique_modas <- function(x){
return(length(x[!is.na(x)]))
}
num_modas = apply(view_modas, 1, unique_modas)
catch_frequency = weighted_frequency(length = length, frequency = sample_frequency, a = 0.003925, b = 3.2178, catch =  50000)
plot(length, catch_frequency, type = "l", lwd = 2, col = 4, ylab = "Catch (kg)", xlab = "Length (cm)")
out_modas = Bhattacharya(x = catch_frequency, groups = num_modas)
cohortes <- NULL
for(i in 1:length(out_modas$tableBhatt$Population)){
N = out_modas$tableBhatt$Population[i]
mu = out_modas$tableBhatt$Mean[i]
sigma = out_modas$outL$sigma[i]
cohortei = cohort_to_length(cohort = c(N, mu, sigma), lower = 5, upper = 20)
cohortes = rbind(cohortes, cohortei)
}
# plots
plot(length, catch_frequency, type = "l", lwd = 2, col = 4, ylab = "Catch (kg)", xlab = "Length (cm)")
lines(length, cohortes[1,], col = 2)
lines(length, cohortes[2,], col = 2)
lines(length, cohortes[1,], col = 3, lty = 2)
lines(length, cohortes[2,], col = 3)
# plots
plot(length, catch_frequency, type = "l", lwd = 2, ylab = "Catch (kg)", xlab = "Length (cm)")
lines(length, cohortes[1,], col = 3, lty = 2)
lines(length, cohortes[2,], col = 3, lty = 2)
library(fenix)
match.fun(FUN)
match.fun(ddnorm1)
library(fenix)
library(fenix)
# Sample (Peruvian anchovy)
sample_frequency <- c(0,0,0,0,0,0,0,0,0,2,7,14,22,15,13,12,17,22,35,28,7,4,1,0,0,0,0,0,0,0,0)
length <- seq(5,20, by = 0.5)
# identify groups
view_modas <- modas(matrix(sample_frequency, nrow = 1), Lmin = 5, Lmax = 20, dL = 0.5, umbral = 10)
# number of groups
num_modas = apply(view_modas, 1, unique_modas)
# weighted
catch_frequency = weighted_frequency(length = length, frequency = sample_frequency, a = 0.003925, b = 3.2178, catch =  50000)
plot(length, catch_frequency, type = "l", lwd = 2, ylab = "Catch (kg)", xlab = "Length (cm)")
# bhattacharya
out_cohortes = Bhattacharya(x = catch_frequency, groups = num_modas)
# rebuild the cohorts
cohortes <- NULL
for(i in 1:length(out_cohortes$tableBhatt$Population)){
N = out_cohortes$tableBhatt$Population[i]
mu = out_cohortes$tableBhatt$Mean[i]
sigma = out_cohortes$outL$sigma[i]
cohortei = cohort_to_length(cohort = c(N, mu, sigma), lower = 5, upper = 20)
cohortes = rbind(cohortes, cohortei)
}
# plots
plot(length, catch_frequency, type = "l", lwd = 2, ylab = "Catch (kg)", xlab = "Length (cm)")
lines(length, cohortes[1,], col = 3, lty = 2)
lines(length, cohortes[2,], col = 3, lty = 2)
library(fenix)
# Sample (Peruvian anchovy)
sample_frequency <- c(0,0,0,0,0,0,0,0,0,2,7,14,22,15,13,12,17,22,35,28,7,4,1,0,0,0,0,0,0,0,0)
length <- seq(5,20, by = 0.5)
# identify groups
view_modas <- modas(matrix(sample_frequency, nrow = 1), Lmin = 5, Lmax = 20, dL = 0.5, umbral = 10)
# number of groups
num_modas = apply(view_modas, 1, unique_modas)
# weighted
catch_frequency = weighted_frequency(length = length, frequency = sample_frequency, a = 0.003925, b = 3.2178, catch =  50000)
plot(length, catch_frequency, type = "l", lwd = 2, ylab = "Catch (number of individuals)", xlab = "Length (cm)")
# bhattacharya
out_cohortes = Bhattacharya(x = catch_frequency, groups = num_modas)
# rebuild the cohorts
cohortes <- NULL
for(i in 1:length(out_cohortes$tableBhatt$Population)){
N = out_cohortes$tableBhatt$Population[i]
L = out_cohortes$tableBhatt$Mean[i]
S = out_cohortes$outL$sigma[i]
cohortei = cohort_to_length(cohort = c(N, L, S), lower = 5, upper = 20)
cohortes = rbind(cohortes, cohortei)
}
# plots
plot(length, catch_frequency, type = "l", lwd = 2, ylab = "Catch (number of individuals)", xlab = "Length (cm)")
lines(length, cohortes[1,], col = 3, lty = 2)
lines(length, cohortes[2,], col = 3, lty = 2)
library(fenix)
library(fenix)
library(fenix)
weighted_frequency
library(fenix)
